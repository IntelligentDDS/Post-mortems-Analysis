RCA - Azure Active Directory - Authentication Errors
Summary: Between 08:18 and 11:25 UTC on 06 Apr 2018, a subset of customers may have experienced difficulties when attempting to authenticate into resources with Azure Active Directory (AAD) dependencies, the primary impact being experienced for resources located in Asia, Oceania, and European regions. This stemmed from incorrect data mappings in two scale units which caused degraded authentication service for impacted customers, impacting approximately 2.5% of tenants. Downstream impact was reported by some Azure services during the impact period. Customers may have experienced for the following services: Backup: Failures for the registration of new containers and backup/restore operations StorSimple: New device registration failures and StorSimple management/communication failures Azure Bot Service: Bots reporting as unresponsive Visual Studio Team Services: Higher execution times and failures while getting AAD tokens in multiple regions Media Services: Authentication failures Azure Site Recovery: New registrations and VM replications may also have failed Virtual Machines: Failures when starting VMs. Existing VMs were not impacted We are aware that other Microsoft services, outside of Azure, were impacted. Those services will communicate to customers via their appropriate channels. Root cause and mitigation: Due to a regression introduced in a recent update in our data storage service that was applied to a subset of our replicated data stores, data objects were moved to an incorrect location in a single replicated data store in each of the two impacted scale units. These changes were then replicated to all the replicas in each of the two scale units. After the changes replicated, Azure AD frontend services were no longer able to access the moved objects, causing authentication and provisioning requests to fail. Only a subset of Azure AD scale units were impacted due to the nature of the defect and the phased update rollout of the data storage service. During the impact period, authentication and provisioning failures were contained to the impacted scale units. As a result, approximately 2.5% of tenants will have experienced authentication failures. Timeline: 08:18 UTC - Authentication failures when authenticating to Azure Active Directory detected across a subset of tenants in Asia-Pacific and Oceania. 08:38 UTC - Automated alerts notified Engineers about the incident in APAC and Oceania regions. 09:11 UTC - Authentication failures when authenticating to Azure Active Directory detected across a subset of tenants in Europe. 09:22 UTC - Automated alerts notified engineers about the incident in Europe. As part of the earlier alerts, Engineers already investigating. 10:45 UTC - Underlying issue was identified and engineers started evaluating mitigation steps. 11:21 UTC - Mitigation steps applied to impacted scale units. 11:25 UTC - Mitigation and service recovery confirmed. Next steps: We understand the impact this has caused to our customers, we apologize for this and are committed to making the necessary improvements to the Microsoft Azure Platform and our processes to help ensure such incidents do not occur in the future. In this case, this includes (but is not limited to): 1. Isolate and deprecate replicas running the updated version of the data store service [Complete] 2. A fix to eliminate the regression is being developed and will be deployed soon [In Progress] 3. Improve telemetry to detect unexpected data movement of data objects to incorrect location [In Progress] 4. Improve resiliency by updating data storage service to prevent impact should similar changes occur in the data object location [In Progress] Provide feedback: Please help us improve the Azure customer communications experience by taking our survey https://survey.microsoft.com/698785
